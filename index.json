[{"content":"ğŸ‘‹ Hello! è¿™é‡Œæ˜¯æœ¨æœ¨çš„å°ç«™ã€‚\nè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œæš‚æ—¶ä¸çŸ¥é“å†™ä¸€äº›ä»€ä¹ˆï¼Œè®°å½•æˆ‘è‡ªå·±çš„ç¢ç¢å¿µï¼Œä¸çˆ±å‘æœ‹å‹åœˆå’Œç©ºé—´ï¼Œäºæ˜¯å‘åœ¨è¿™é‡Œäº†ã€‚\n","permalink":"https://blog.l50.top/about/","summary":"\u003ch3 id=\"-hello\"\u003eğŸ‘‹ Hello!\u003c/h3\u003e\n\u003cp\u003eè¿™é‡Œæ˜¯æœ¨æœ¨çš„å°ç«™ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œæš‚æ—¶ä¸çŸ¥é“å†™ä¸€äº›ä»€ä¹ˆï¼Œè®°å½•æˆ‘è‡ªå·±çš„ç¢ç¢å¿µï¼Œä¸çˆ±å‘æœ‹å‹åœˆå’Œç©ºé—´ï¼Œäºæ˜¯å‘åœ¨è¿™é‡Œäº†ã€‚\u003c/p\u003e","title":"About me"},{"content":"test\n","permalink":"https://blog.l50.top/posts/techs/test/","summary":"\u003cp\u003etest\u003c/p\u003e","title":"test"},{"content":" å†™åœ¨å‰é¢ï¼š å¦‚æœæœªæ¥çš„æŸä¸€å¤©ï¼Œä½ å†æ¬¡å‘ç°æ˜æ˜å·²ç»ä»å­˜å‚¨æ¡¶é‡Œæ°¸ä¹…åˆ é™¤çš„å›¾ç‰‡ï¼Œç«Ÿç„¶è¿˜èƒ½åœ¨æµè§ˆå™¨é‡Œæ­£å¸¸è®¿é—®ï¼Œç”šè‡³ Cloudflare ç¼“å­˜æ€ä¹ˆæ¸…éƒ½æ¸…ä¸æ‰ã€‚ è¯·å†·é™ï¼Œä¸è¦æ€€ç–‘ CDN å‡ºäº† Bugï¼Œä¹Ÿä¸è¦è§‰å¾—é‡åˆ°äº†çµå¼‚äº‹ä»¶ã€‚ å›æ¥çœ‹è¿™ç¯‡ç¬”è®°ï¼Œå‡¶æ‰‹å°±æ˜¯å½“åˆé‚£ä¸ªâ€œè¿‡äºè´´å¿ƒâ€çš„å¼€æºé¡¹ç›®ä»£ç ã€‚\nğŸ‘» çµå¼‚ç°è±¡ï¼šå›¾ç‰‡â€œå¤æ´»â€äº† äº‹æƒ…çš„èµ·å› å¾ˆç®€å•ï¼šæˆ‘åŸºäºå¼€æºé¡¹ç›® MarSeventh/CloudFlare-ImgBed æ­å»ºäº†è‡ªå·±çš„å›¾åºŠï¼Œåç«¯å­˜å‚¨ä½¿ç”¨çš„æ˜¯ Cloudflare R2ã€‚\næŸå¤©æˆ‘å†³å®šé‡æ„å›¾åºŠï¼Œäºæ˜¯æ¸…ç©ºäº† R2 å­˜å‚¨æ¡¶ï¼Œç”šè‡³åˆ é™¤äº†æ•´ä¸ªé¡¹ç›®é‡æ–°éƒ¨ç½²ã€‚æŒ‰ç†è¯´ï¼Œæ—§çš„å›¾ç‰‡é“¾æ¥åº”è¯¥å…¨éƒ¨å˜çº¢ï¼ˆ404 Not Foundï¼‰ã€‚\nç„¶è€Œï¼Œè¯¡å¼‚çš„äº‹æƒ…å‘ç”Ÿäº†ï¼š\nè®¿é—®æ—§å›¾ç‰‡é“¾æ¥ï¼šå›¾ç‰‡ä¾ç„¶æ­£å¸¸åŠ è½½ï¼Œæ¯«å‘æ— æŸã€‚ æ£€æŸ¥ R2 æ¡¶ï¼šé‡Œé¢ç©ºç©ºå¦‚ä¹Ÿï¼Œæ ¹æœ¬æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ã€‚ æ£€æŸ¥ KV æ•°æ®åº“ï¼šä¹Ÿæ˜¯ç©ºçš„ï¼Œæ²¡æœ‰è®°å½•ã€‚ CDN ç¼“å­˜ï¼šæˆ‘åœ¨ Cloudflare åå°ç‚¹å‡»äº† Purge All Cacheï¼ˆæ¸…é™¤æ‰€æœ‰ç¼“å­˜ï¼‰ã€‚ ç»“æœï¼šæ¸…é™¤ç¼“å­˜åï¼Œç¬¬ä¸€æ¬¡è®¿é—®çŸ­æš‚å˜æ…¢ï¼ˆå›æºï¼‰ï¼Œç´§æ¥ç€æ§åˆ¶å°å†æ¬¡æ˜¾ç¤º CF-Cache-Status: HITã€‚ ä¸€å¼ åœ¨ç‰©ç†å±‚é¢å·²ç»è¢«â€œé”€æ¯â€çš„å›¾ç‰‡ï¼Œä¸ºä»€ä¹ˆä¼šåƒå¹½çµä¸€æ ·ï¼Œæ¯æ¬¡æ¸…é™¤ç¼“å­˜åéƒ½èƒ½åŸåœ°å¤æ´»ï¼Ÿ\n1. é¡¹ç›®çš„å‰ä¸–ä»Šç”Ÿ CloudFlare-ImgBed è¿™ä¸ªé¡¹ç›®ï¼Œæœ€æ—©å…¶å®æ˜¯åŸºäº Telegra.phï¼ˆTelegram çš„åŒ¿åå‘å¸ƒå¹³å°ï¼‰åšçš„ã€‚\næ—©æœŸé€»è¾‘ï¼šç”¨æˆ·ä¸Šä¼  -\u0026gt; Worker è½¬å‘ç»™ Telegra.ph -\u0026gt; è¿”å› Telegra.ph çš„å›¾ç‰‡é“¾æ¥ã€‚ åæœŸå‡çº§ï¼šCloudflare æ¨å‡ºäº† R2 å­˜å‚¨ï¼Œä½œè€…ä¸ºäº†ç¨³å®šæ€§ï¼Œå¢åŠ äº† R2 æ”¯æŒï¼ŒæŠŠ R2 ä½œä¸ºé¦–é€‰å­˜å‚¨ã€‚ 2. â€œTelegra.phç¦ç”¨å…è´¹çš„æ¥å£ ä»¥å‰ä¸Šä¼ åˆ° Telegraph çš„å›¾ç‰‡ä¸å—å½±å“ï¼Œç°åœ¨æ— æ³•å†ç™½å«–äº†ï¼Œä¸ºäº†é¿å…å·²ç»ä¸Šä¼ çš„å›¾ç‰‡æ— æ³•ä½¿ç”¨ï¼Œä»£ç åº•å±‚é€»è¾‘ä¼šç»§ç»­try get Telegra.phçš„å›¾ç‰‡ã€‚\n3. çœŸç›¸å¤§ç™½ è¿™å°±æ˜¯â€œç¼“å­˜å¤æ´»â€çš„å®Œæ•´é“¾æ¡ï¼š\næˆ‘ç‚¹äº†â€œæ¸…é™¤ç¼“å­˜â€ -\u0026gt; è¾¹ç¼˜èŠ‚ç‚¹ç¼“å­˜æ¸…ç©ºã€‚\næˆ‘è®¿é—®å›¾ç‰‡ -\u0026gt; è¾¹ç¼˜èŠ‚ç‚¹å‘ç°æ²¡ç¼“å­˜ -\u0026gt; è¯·æ±‚å›æºç»™ Workerã€‚\nWorker å» R2 æŸ¥ -\u0026gt; å‘ç°æ–‡ä»¶æ²¡äº†ï¼ˆå› ä¸ºæˆ‘åˆ äº†ï¼‰ã€‚\nWorker è§¦å‘å…œåº•é€»è¾‘ -\u0026gt; å·å·å» telegra.ph è¯·æ±‚åŒåæ–‡ä»¶ã€‚\nç”±äº Telegra.ph çš„å›¾ç‰‡æ˜¯æ°¸ä¹…å­˜å‚¨ä¸”æ— æ³•åˆ é™¤çš„ -\u0026gt; Worker æ‹¿åˆ°äº†å›¾ç‰‡ï¼\nWorker æŠŠå›¾ç‰‡ä¼ å›ç»™è¾¹ç¼˜èŠ‚ç‚¹ -\u0026gt; è¾¹ç¼˜èŠ‚ç‚¹é‡æ–°ç¼“å­˜è¯¥å›¾ç‰‡ -\u0026gt; ç”¨æˆ·çœ‹åˆ°å›¾ç‰‡ã€‚\næ—¢ç„¶æ‰¾åˆ°äº†åŸå› ï¼Œè§£å†³åŠæ³•å°±å¾ˆç®€å•ã€‚æˆ‘ä¸å¸Œæœ›æˆ‘çš„å›¾åºŠå’Œä¸å¯æ§çš„ Telegra.ph è—•æ–­ä¸è¿ï¼Œæˆ‘è¦å®ƒå˜æˆä¸€ä¸ªçº¯ç²¹çš„ R2 å›¾åºŠã€‚\nä¿®æ”¹ Worker ä»£ç ï¼š\næ‰¾åˆ°ç±»ä¼¼ fetch('https://telegra.ph/file/' + ...) çš„ä»£ç æ®µï¼Œå°†å…¶åˆ é™¤æˆ–æ³¨é‡Šï¼Œæ”¹ä¸ºç›´æ¥è¿”å› 404ã€‚\nJavaScript\n1 2 3 4 5 6 7 8 9 // ä¿®æ”¹åçš„é€»è¾‘ const file = await env.R2_BUCKET.get(key); if (!file) { // R2 æ²¡æ‰¾åˆ°ï¼Ÿé‚£å°±æ˜¯æ²¡äº†ï¼Œåˆ«å»åˆ«å¤„æ‰¾äº† return new Response(\u0026#34;Image Not Found in R2.\u0026#34;, { status: 404 }); } return new Response(file.body, ...); ä¿®æ”¹éƒ¨ç½²åï¼Œå†æ¬¡æ¸…é™¤ CDN ç¼“å­˜ã€‚è¿™ä¸€æ¬¡ï¼Œå¹½çµå›¾ç‰‡ç»ˆäºå½»åº•æ¶ˆå¤±äº†ï¼Œè¿”å›äº†ä»¤æˆ‘å®‰å¿ƒçš„ 404 Not Foundã€‚\n","permalink":"https://blog.l50.top/posts/techs/%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95%E5%88%A0%E4%B8%8D%E6%8E%89%E7%9A%84%E5%B9%BD%E7%81%B5%E5%9B%BE%E7%89%87/","summary":"\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eå†™åœ¨å‰é¢ï¼š\u003c/strong\u003e\nå¦‚æœæœªæ¥çš„æŸä¸€å¤©ï¼Œä½ å†æ¬¡å‘ç°æ˜æ˜å·²ç»ä»å­˜å‚¨æ¡¶é‡Œæ°¸ä¹…åˆ é™¤çš„å›¾ç‰‡ï¼Œç«Ÿç„¶è¿˜èƒ½åœ¨æµè§ˆå™¨é‡Œæ­£å¸¸è®¿é—®ï¼Œç”šè‡³ Cloudflare ç¼“å­˜æ€ä¹ˆæ¸…éƒ½æ¸…ä¸æ‰ã€‚\n\u003cstrong\u003eè¯·å†·é™ï¼Œä¸è¦æ€€ç–‘ CDN å‡ºäº† Bugï¼Œä¹Ÿä¸è¦è§‰å¾—é‡åˆ°äº†çµå¼‚äº‹ä»¶ã€‚\u003c/strong\u003e\nå›æ¥çœ‹è¿™ç¯‡ç¬”è®°ï¼Œå‡¶æ‰‹å°±æ˜¯å½“åˆé‚£ä¸ªâ€œè¿‡äºè´´å¿ƒâ€çš„å¼€æºé¡¹ç›®ä»£ç ã€‚\u003c/p\u003e","title":"ã€è¸©å‘è®°å½•ã€‘åˆ ä¸æ‰çš„â€œå¹½çµå›¾ç‰‡â€"},{"content":" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # 1. åˆ›å»ºä¸€ä¸ª 2G çš„ç©ºæ–‡ä»¶ (2048MB) dd if=/dev/zero of=/swapfile bs=1M count=2048 status=progress # 2. è®¾ç½®æƒé™ (å®‰å…¨èµ·è§ï¼Œåªæœ‰ root èƒ½è¯»å†™) chmod 600 /swapfile # 3. æŠŠå®ƒæ ¼å¼åŒ–ä¸º Swap mkswap /swapfile # 4. å¯ç”¨ Swap swapon /swapfile # 5. æ°¸ä¹…ç”Ÿæ•ˆ (å†™å…¥ fstabï¼Œé˜²æ­¢é‡å¯åä¸¢å¤±) echo \u0026#39;/swapfile none swap sw 0 0\u0026#39; \u0026gt;\u0026gt; /etc/fstab # 6. è°ƒæ•´ Swap ç§¯ææ€§ (Swappiness) # é»˜è®¤æ˜¯ 60ï¼Œå»ºè®®æ”¹ä¸º 10ï¼Œè®©ç³»ç»Ÿå°½é‡å…ˆç”¨ç‰©ç†å†…å­˜ï¼Œåˆ«åŠ¨ä¸åŠ¨å°±ç”¨ç¡¬ç›˜ sysctl vm.swappiness=10 echo \u0026#39;vm.swappiness=10\u0026#39; \u0026gt;\u0026gt; /etc/sysctl.conf å…³äºswapç§¯ææ€§ï¼Œå»ºè®®ä¸ºä»€ä¹ˆæ˜¯10ï¼Ÿé»˜è®¤çš„60çš„å¼Šç«¯æ˜¯ä»€ä¹ˆï¼Ÿ\nç®€å•æ¥è¯´ï¼švm.swappiness è¿™ä¸ªå‚æ•°å†³å®šäº†ä½ çš„ Linux ç³»ç»Ÿæœ‰å¤šâ€œå–œæ¬¢â€ä½¿ç”¨ Swapã€‚\nèŒƒå›´æ˜¯ 0 åˆ° 100ã€‚\nå€¼è¶Šé«˜ = è¶Šç§¯æåœ°ä½¿ç”¨ Swapï¼ˆè¶Šæ—©æŠŠå†…å­˜é‡Œçš„ä¸œè¥¿æ¬åˆ°ç¡¬ç›˜ï¼‰ã€‚\nå€¼è¶Šä½ = è¶Šæ¶ˆæåœ°ä½¿ç”¨ Swapï¼ˆæ­»èµ–åœ¨å†…å­˜é‡Œï¼Œä¸åˆ°ä¸‡ä¸å¾—å·²ä¸ç”¨ç¡¬ç›˜ï¼‰ã€‚\næˆ‘å»ºè®®è®¾ç½®ä¸º 10 è€Œä¸æ˜¯é»˜è®¤ 60 çš„æ ¸å¿ƒåŸå› ï¼Œæ˜¯å› ä¸º VPS çš„ç¡¬ç›˜ IO é€šå¸¸æ˜¯æ€§èƒ½ç“¶é¢ˆã€‚\n1. é»˜è®¤å€¼ 60 çš„å¼Šç«¯æ˜¯ä»€ä¹ˆï¼Ÿ é»˜è®¤å€¼ 60 æ˜¯ä¸€ä¸ªä¸ºæ¡Œé¢ç”µè„‘è®¾è®¡çš„æŠ˜ä¸­æ–¹æ¡ˆï¼Œå®ƒçš„é€»è¾‘æ˜¯ï¼š\nâ€œå†…å­˜ç©ºç€ä¹Ÿæ˜¯ç©ºç€ï¼Œä¸å¦‚æŠŠé‚£äº›æš‚æ—¶ä¸ç”¨çš„ç¨‹åºå†…å­˜ï¼ˆæ¯”å¦‚ä½ æœ€å°åŒ–çš„æµè§ˆå™¨ï¼‰æ¬åˆ° Swap é‡Œå»ï¼Œè…¾å‡ºç‰©ç†å†…å­˜æ¥åšæ–‡ä»¶ç¼“å­˜ (Page Cache)ï¼Œè¿™æ ·ä»¥åè¯»å–æ–‡ä»¶ä¼šæ›´å¿«ã€‚â€\nä½†åœ¨ VPS æœåŠ¡å™¨ä¸Šï¼Œè¿™ä¼šå¯¼è‡´ä¸¤ä¸ªé—®é¢˜ï¼š\nâ€œå‡â€å†…å­˜ä¸è¶³ï¼ˆè¿‡æ—© Swapï¼‰ï¼š å³ä½¿ä½ çš„ 2.5G å†…å­˜è¿˜æœ‰ 1G ç©ºé—²ï¼Œåªè¦ç³»ç»Ÿè¿›è¡Œäº†ä¸€äº›æ–‡ä»¶è¯»å†™ï¼ˆæ¯”å¦‚æ—¥å¿—åˆ‡å‰²ã€å¤‡ä»½ã€æˆ–è€…ç®€å•çš„ apt updateï¼‰ï¼ŒLinux å¯èƒ½ä¼šä¸ºäº†è…¾å‡ºç©ºé—´å­˜è¿™äº›æ–‡ä»¶çš„ç¼“å­˜ï¼Œè€ŒæŠŠä½ çš„ MySQL æˆ– Nginx çš„ä¸€éƒ¨åˆ†â€œé—²ç½®æ•°æ®â€æŒ¤åˆ° Swap å»ã€‚\nIO æŠ–åŠ¨ï¼ˆå¡é¡¿ï¼‰ï¼š å½“æœ‰ç”¨æˆ·çªç„¶è¯·æ±‚é‚£éƒ¨åˆ†è¢«æŒ¤åˆ° Swap é‡Œçš„æ•°æ®æ—¶ï¼Œç³»ç»Ÿå¿…é¡»ä»æ…¢é€Ÿçš„ç¡¬ç›˜æŠŠå®ƒè¯»å›å†…å­˜ï¼ˆSwap Inï¼‰ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨å“åº”çªç„¶å˜æ…¢å‡ ç§’é’Ÿã€‚å¯¹äº Web æœåŠ¡æ¥è¯´ï¼Œè¿™ç§å»¶è¿Ÿæ˜¯ä¸å¯æ¥å—çš„ã€‚\né€šä¿—çš„æ¯”å–»ï¼ˆåŠå…¬æ¡Œï¼‰ï¼š\nå†…å­˜ = ä½ çš„åŠå…¬æ¡Œï¼ˆæ‹¿å–æå¿«ï¼‰ã€‚\nSwap = æ—è¾¹çš„æ¡£æ¡ˆæŸœï¼ˆæ‹¿å–å¾ˆæ…¢ï¼‰ã€‚\nSwappiness = 60ï¼š åªè¦æ¡Œå­ç”¨äº† 40%ï¼Œç®¡ç†å‘˜å°±å¼€å§‹æŠŠä½ æš‚æ—¶ä¸çœ‹çš„æ–‡ä»¶æ”¶è¿›æ¡£æ¡ˆæŸœï¼Œä¸ºäº†åœ¨æ¡Œä¸Šè…¾å‡ºç©ºåœ°æ”¾â€œå¯èƒ½ä»¥åä¼šçœ‹çš„æ‚å¿—â€ï¼ˆç¼“å­˜ï¼‰ã€‚å½“ä½ çªç„¶è¦çœ‹é‚£ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿˜å¾—å»æŸœå­é‡Œç¿»ï¼Œå¾ˆæ…¢ã€‚\n2. ä¸ºä»€ä¹ˆå»ºè®®æ˜¯ 10ï¼Ÿ è®¾ç½®ä¸º 10ï¼Œæ˜¯å‘Šè¯‰å†…æ ¸ï¼š\nâ€œå“ªæ€•æ­¤æ—¶æ–‡ä»¶ç¼“å­˜çš„ç©ºé—´å¾ˆå°‘äº†ï¼Œä¹Ÿåƒä¸‡åˆ«åŠ¨æˆ‘åº”ç”¨ç¨‹åºå ç”¨çš„å†…å­˜ã€‚é™¤éç‰©ç†å†…å­˜çœŸçš„çœŸçš„å¿«è¢«æ’‘çˆ†äº†ï¼ˆé€šå¸¸æ˜¯å ç”¨è¾¾åˆ° 90% ä»¥ä¸Šï¼‰ï¼Œå†å¼€å§‹ç”¨ Swapã€‚â€\nå¸¦æ¥çš„å¥½å¤„ï¼š\næœ€å¤§åŒ–åˆ©ç”¨ç‰©ç†å†…å­˜ï¼š ä½ çš„ MySQLã€PHPã€Java è¿›ç¨‹ä¼šç‰¢ç‰¢åœ°å‘†åœ¨é€Ÿåº¦æœ€å¿«çš„ç‰©ç†å†…å­˜é‡Œã€‚\nå‡å°‘ç¡¬ç›˜ IOï¼š VPS çš„ç¡¬ç›˜ï¼ˆå°¤å…¶æ˜¯å…±äº«ç¡¬ç›˜ï¼‰è¯»å†™é€šå¸¸ä¸å¿«ã€‚å‡å°‘ Swap çš„è¯»å†™èƒ½æ˜¾è‘—é™ä½ç³»ç»Ÿçš„è´Ÿè½½ï¼ˆLoad Averageï¼‰ã€‚\nå“åº”æ›´ç¨³ï¼š é¿å…äº†å› ä¸ºâ€œSwap æ¢å…¥æ¢å‡ºâ€é€ æˆçš„è«åå…¶å¦™çš„å¡é¡¿ã€‚\né€šä¿—çš„æ¯”å–»ï¼ˆSwappiness = 10ï¼‰ï¼š ç®¡ç†å‘˜éå¸¸æ‡’ï¼Œåªè¦æ¡Œå­ä¸Šè¿˜èƒ½å¡ä¸‹ä¸€å¼ çº¸ï¼Œä»–å°±ç»ä¸æŠŠæ–‡ä»¶æ”¶è¿›æ¡£æ¡ˆæŸœã€‚è¿™æ ·ä½ ä¼¸æ‰‹å°±èƒ½æ‹¿åˆ°æ‰€æœ‰æ­£åœ¨ç”¨çš„æ–‡ä»¶ï¼Œå·¥ä½œæ•ˆç‡æœ€é«˜ã€‚\n3. ä¸ºä»€ä¹ˆä¸è®¾ç½®ä¸º 0ï¼Ÿ è™½ç„¶è®¾ç½®ä¸º 0 å¯ä»¥æœ€å¤§é™åº¦ç¦æ­¢ Swapï¼Œä½†åœ¨ç°ä»£ Linux å†…æ ¸ä¸­ï¼Œ0 å¯èƒ½ä¼šå¯¼è‡´ä¸€ç§æç«¯æƒ…å†µï¼šå½“å†…å­˜çœŸçš„è€—å°½æ—¶ï¼Œç³»ç»Ÿå¯èƒ½ä¼šç›´æ¥è§¦å‘ OOM Killer (å†…å­˜æº¢å‡ºæ€æ‰‹)ï¼Œæš´åŠ›æ€æ‰ä½ çš„ MySQL æˆ– Nginx è¿›ç¨‹ï¼Œè€Œä¸æ˜¯å°è¯•ç”¨ Swap æ•‘æ€¥ã€‚\næ‰€ä»¥ï¼Œ10 æ˜¯ä¸€ä¸ªé»„é‡‘å¹³è¡¡ç‚¹ï¼š\nå¹³æ—¶å‡ ä¹ä¸ç”¨ Swapï¼Œä¿è¯é€Ÿåº¦ã€‚\nçœŸé‡åˆ°çªå‘æµé‡æŠŠå†…å­˜æ’‘çˆ†æ—¶ï¼Œè¿˜æœ‰ Swap å…œåº•ï¼Œé˜²æ­¢æœåŠ¡ç›´æ¥å´©æºƒã€‚\n","permalink":"https://blog.l50.top/posts/techs/swap%E4%BA%A4%E6%8D%A2%E7%A9%BA%E9%97%B4%E8%AE%BE%E7%BD%AE%E5%A4%9A%E5%A4%A7%E5%A5%BD%E5%85%B6%E7%A7%AF%E6%9E%81%E6%80%A7swappiness%E5%8F%88%E6%98%AF%E5%A4%9A%E5%B0%91%E5%90%88%E9%80%82/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# 1. åˆ›å»ºä¸€ä¸ª 2G çš„ç©ºæ–‡ä»¶ (2048MB)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edd if=/dev/zero of=/swapfile bs=1M count=2048 status=progress\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# 2. è®¾ç½®æƒé™ (å®‰å…¨èµ·è§ï¼Œåªæœ‰ root èƒ½è¯»å†™)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod 600 /swapfile\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# 3. æŠŠå®ƒæ ¼å¼åŒ–ä¸º Swap\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkswap /swapfile\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# 4. å¯ç”¨ Swap\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eswapon /swapfile\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# 5. æ°¸ä¹…ç”Ÿæ•ˆ (å†™å…¥ fstabï¼Œé˜²æ­¢é‡å¯åä¸¢å¤±)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eecho \u0026#39;/swapfile none swap sw 0 0\u0026#39; \u0026gt;\u0026gt; /etc/fstab\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# 6. è°ƒæ•´ Swap ç§¯ææ€§ (Swappiness)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# é»˜è®¤æ˜¯ 60ï¼Œå»ºè®®æ”¹ä¸º 10ï¼Œè®©ç³»ç»Ÿå°½é‡å…ˆç”¨ç‰©ç†å†…å­˜ï¼Œåˆ«åŠ¨ä¸åŠ¨å°±ç”¨ç¡¬ç›˜\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esysctl vm.swappiness=10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eecho \u0026#39;vm.swappiness=10\u0026#39; \u0026gt;\u0026gt; /etc/sysctl.conf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eå…³äºswapç§¯ææ€§ï¼Œå»ºè®®ä¸ºä»€ä¹ˆæ˜¯10ï¼Ÿé»˜è®¤çš„60çš„å¼Šç«¯æ˜¯ä»€ä¹ˆï¼Ÿ\u003c/p\u003e","title":"Swapäº¤æ¢ç©ºé—´è®¾ç½®å¤šå¤§å¥½ï¼Ÿå…¶ç§¯ææ€§ï¼ˆSwappinessï¼‰åˆæ˜¯å¤šå°‘åˆé€‚ï¼Ÿ"},{"content":"è¦å…³é—­æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š\næŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š\né¦–å…ˆï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨ï¼š\n1 docker ps è¿™å°†åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨åŠå…¶ç›¸å…³ä¿¡æ¯ã€‚\nåœæ­¢æ‰€æœ‰å®¹å™¨ï¼š\nå¦‚æœè¦åœæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 docker stop $(docker ps -aq) è¿™ä¸ªå‘½ä»¤ä¼šåœæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚\nåˆ é™¤æ‰€æœ‰å®¹å™¨ï¼ˆå¯é€‰ï¼‰ï¼š\nå¦‚æœéœ€è¦åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 docker rm $(docker ps -aq) è¿™å°†åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨ã€‚è¯·æ³¨æ„ï¼Œè¿™å°†æ°¸ä¹…åˆ é™¤è¿™äº›å®¹å™¨ã€‚\nå…³é—­ Docker æœåŠ¡ï¼š\næœ€åï¼Œå¦‚æœéœ€è¦åœæ­¢ Docker æœåŠ¡æœ¬èº«ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 sudo systemctl stop docker è¿™å°†åœæ­¢ Docker æœåŠ¡ã€‚\né€šè¿‡æ‰§è¡Œä»¥ä¸Šæ­¥éª¤ï¼Œä½ å¯ä»¥åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨ï¼Œå¹¶å…³é—­ Docker æœåŠ¡ã€‚è¯·ç¡®ä¿ä½ æƒ³è¦æ‰§è¡Œè¿™äº›æ“ä½œï¼Œå¹¶æ˜ç™½è¿™å°†ä¼šå½±å“æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚\nè¦å¯åŠ¨æ‰€æœ‰å·²åœæ­¢çš„ Docker å®¹å™¨ï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š\næŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼š\né¦–å…ˆï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰çš„ Docker å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢çš„å®¹å™¨ï¼‰ï¼š\n1 docker ps -a è¿™å°†åˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„çŠ¶æ€ï¼ˆè¿è¡Œä¸­æˆ–å·²åœæ­¢ï¼‰ã€‚\nå¯åŠ¨æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨ï¼š\nå¦‚æœä½ æƒ³å¯åŠ¨æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 docker start $(docker ps -aqf \u0026#34;status=exited\u0026#34;) è¿™ä¸ªå‘½ä»¤ä¼šå¯åŠ¨æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨ã€‚\n","permalink":"https://blog.l50.top/posts/techs/docker%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/","summary":"\u003cp\u003eè¦å…³é—­æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eæŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨\u003c/strong\u003eï¼š\u003c/p\u003e\n\u003cp\u003eé¦–å…ˆï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker ps\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eè¿™å°†åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨åŠå…¶ç›¸å…³ä¿¡æ¯ã€‚\u003c/p\u003e","title":"Dockerå¸¸ç”¨æ“ä½œ"},{"content":"è¦åœ¨ Debian ä¸Šè‡ªç­¾åè¯ä¹¦ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ OpenSSL å·¥å…·ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„æ­¥éª¤æ¥ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼š å®‰è£… OpenSSLï¼š å¦‚æœæ‚¨çš„ç³»ç»Ÿä¸Šå°šæœªå®‰è£… OpenSSLï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…å®ƒï¼š\n1 2 sudo apt-get update sudo apt-get install openssl ç”Ÿæˆç§é’¥ï¼š ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆç§é’¥æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œprivate.keyï¼‰ï¼š\n1 openssl genpkey -algorithm RSA -out private.key åœ¨ç”Ÿæˆç§é’¥æ—¶ï¼Œæ‚¨å¯ä»¥é€‰æ‹©å…¶ä»–ç®—æ³•å’Œå‚æ•°ï¼Œæ ¹æ®æ‚¨çš„éœ€æ±‚è¿›è¡Œè°ƒæ•´ã€‚\nç”Ÿæˆè¯ä¹¦è¯·æ±‚ï¼š ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆè¯ä¹¦è¯·æ±‚æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œcertificate.csrï¼‰ï¼š\n1 openssl req -new -key private.key -out certificate.csr åœ¨ç”Ÿæˆè¯ä¹¦è¯·æ±‚æ—¶ï¼Œæ‚¨å°†è¢«è¦æ±‚æä¾›ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚ç»„ç»‡åç§°ã€å¸¸ç”¨åç§°ç­‰ã€‚è¯·æ ¹æ®æ‚¨çš„éœ€æ±‚å¡«å†™è¿™äº›ä¿¡æ¯ã€‚\nç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼š ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ˆä¾‹å¦‚ï¼Œcertificate.crtï¼‰ï¼š\n1 openssl x509 -req -in certificate.csr -signkey private.key -out certificate.crt è¿™å°†ä½¿ç”¨ç§é’¥å¯¹è¯ä¹¦è¯·æ±‚è¿›è¡Œç­¾åï¼Œå¹¶ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ã€‚\nåœ¨ç”Ÿæˆè‡ªç­¾åè¯ä¹¦æ—¶ï¼Œè¯ä¹¦çš„æœ‰æ•ˆæœŸæ˜¯éœ€è¦æŒ‡å®šçš„ã€‚å¦‚æœæ‚¨æ²¡æœ‰æ˜¾å¼æŒ‡å®šæœ‰æ•ˆæœŸï¼ŒOpenSSL é»˜è®¤ä¼šä¸ºè¯ä¹¦è®¾ç½®ä¸€ä¸ªè¾ƒçŸ­çš„æœ‰æ•ˆæœŸï¼Œé€šå¸¸ä¸ºä¸€ä¸ªæœˆã€‚ è¦æŒ‡å®šè‡ªç­¾åè¯ä¹¦çš„æœ‰æ•ˆæœŸï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ OpenSSL çš„ -days å‚æ•°æ¥è®¾ç½®è¯ä¹¦çš„æœ‰æ•ˆå¤©æ•°ã€‚ä¾‹å¦‚ï¼Œè¦å°†è¯ä¹¦çš„æœ‰æ•ˆæœŸè®¾ç½®ä¸ºä¸€å¹´ï¼ˆ365å¤©ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 openssl x509 -req -in certificate.csr -signkey private.key -out certificate.crt -days 365 åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œ-days 365 è¡¨ç¤ºå°†è¯ä¹¦çš„æœ‰æ•ˆæœŸè®¾ç½®ä¸º365å¤©ã€‚æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´æœ‰æ•ˆå¤©æ•°ã€‚\nè¯·æ³¨æ„ï¼Œè‡ªç­¾åè¯ä¹¦çš„æœ‰æ•ˆæœŸåº”æ ¹æ®æ‚¨çš„éœ€æ±‚å’Œå®‰å…¨ç­–ç•¥è¿›è¡Œè®¾ç½®ã€‚è¾ƒçŸ­çš„æœ‰æ•ˆæœŸå¯ä»¥å¢åŠ å®‰å…¨æ€§ï¼Œå› ä¸ºå®ƒè¦æ±‚å®šæœŸæ›´æ–°è¯ä¹¦ï¼Œä½†ä¹Ÿä¼šå¢åŠ ç®¡ç†å·¥ä½œé‡ã€‚è¾ƒé•¿çš„æœ‰æ•ˆæœŸå¯ä»¥å‡å°‘ç®¡ç†å·¥ä½œé‡ï¼Œä½†å¯èƒ½ä¼šé™ä½å®‰å…¨æ€§ï¼Œå› ä¸ºé•¿æœŸæœ‰æ•ˆçš„è¯ä¹¦å¯èƒ½ä¼šè¢«æ»¥ç”¨ã€‚\nåœ¨ç”Ÿæˆè‡ªç­¾åè¯ä¹¦æ—¶ï¼Œè¯·ç¡®ä¿æ ¹æ®å®é™…æƒ…å†µè®¾ç½®åˆé€‚çš„æœ‰æ•ˆæœŸã€‚\n","permalink":"https://blog.l50.top/posts/techs/%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6/","summary":"\u003ch3 id=\"è¦åœ¨-debian-ä¸Šè‡ªç­¾åè¯ä¹¦æ‚¨å¯ä»¥ä½¿ç”¨-openssl-å·¥å…·ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„æ­¥éª¤æ¥ç”Ÿæˆè‡ªç­¾åè¯ä¹¦\"\u003eè¦åœ¨ Debian ä¸Šè‡ªç­¾åè¯ä¹¦ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ OpenSSL å·¥å…·ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„æ­¥éª¤æ¥ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼š\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eå®‰è£… OpenSSLï¼š\u003c/strong\u003e å¦‚æœæ‚¨çš„ç³»ç»Ÿä¸Šå°šæœªå®‰è£… OpenSSLï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…å®ƒï¼š\u003c/p\u003e","title":"æ‰‹åŠ¨ç”Ÿæˆè‡ªç­¾è¯ä¹¦"},{"content":"è¦æ‰‹åŠ¨é…ç½®NGINXå¤šç«™ç‚¹ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š å®‰è£…NGINXï¼šé¦–å…ˆï¼Œç¡®ä¿æ‚¨å·²ç»åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…äº†NGINXã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¿è¡Œé€‚ç”¨äºæ‚¨çš„æ“ä½œç³»ç»Ÿçš„ç›¸åº”å‘½ä»¤æ¥å®‰è£…NGINXã€‚\né…ç½®ç«™ç‚¹æ–‡ä»¶å¤¹ï¼šåœ¨NGINXé…ç½®æ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªç«™ç‚¹éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„é…ç½®æ–‡ä»¶ã€‚é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹æ¥å­˜å‚¨æ‚¨çš„ç«™ç‚¹é…ç½®æ–‡ä»¶ã€‚é€šå¸¸ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä½äº/etc/nginx/sites-available/ç›®å½•ä¸‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºè¯¥æ–‡ä»¶å¤¹ï¼š\n1 sudo mkdir /etc/nginx/sites-available/ åˆ›å»ºç«™ç‚¹é…ç½®æ–‡ä»¶ï¼šåœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶å¤¹ä¸­ï¼Œä¸ºæ¯ä¸ªç«™ç‚¹åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„é…ç½®æ–‡ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨åˆ›å»ºè¿™äº›æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§ä»¥ä¸‹ç¤ºä¾‹è¿›è¡Œé…ç½®ï¼š\n1 2 3 4 5 6 7 8 9 server { listen 80; server_name example.com; root /var/www/example.com; location / { index index.html; } } åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œexample.comæ˜¯æ‚¨çš„ç«™ç‚¹åŸŸåï¼Œ/var/www/example.comæ˜¯æ‚¨çš„ç«™ç‚¹æ–‡ä»¶å¤¹è·¯å¾„ã€‚æ‚¨å¯ä»¥æ ¹æ®æ‚¨çš„å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹ã€‚\nåˆ›å»ºç«™ç‚¹é“¾æ¥ï¼šåˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥å°†ç«™ç‚¹é…ç½®æ–‡ä»¶é“¾æ¥åˆ°/etc/nginx/sites-enabled/ç›®å½•ã€‚è¿™æ ·ï¼ŒNGINXå°†åŠ è½½è¿™äº›é…ç½®æ–‡ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºé“¾æ¥ï¼š\n1 sudo ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/ å°†example.comæ›¿æ¢ä¸ºæ‚¨çš„ç«™ç‚¹é…ç½®æ–‡ä»¶çš„å®é™…åç§°ã€‚\næ£€æŸ¥é…ç½®å¹¶é‡æ–°åŠ è½½NGINXï¼šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥NGINXé…ç½®æ–‡ä»¶çš„è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼š\n1 sudo nginx -t å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œé‡æ–°åŠ è½½NGINXä»¥åº”ç”¨æ–°çš„é…ç½®ï¼š\n1 sudo systemctl reload nginx ç°åœ¨ï¼Œæ‚¨çš„æ–°ç«™ç‚¹åº”è¯¥å·²ç»é…ç½®å¥½äº†ã€‚\né‡å¤æ­¥éª¤3åˆ°æ­¥éª¤5ä»¥é…ç½®æ›´å¤šçš„ç«™ç‚¹ã€‚æ¯ä¸ªç«™ç‚¹éƒ½åº”è¯¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨/etc/nginx/sites-enabled/ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚\nè¯·æ³¨æ„ï¼Œä¸Šè¿°æ­¥éª¤æ˜¯åŸºäºLinuxç³»ç»Ÿçš„ç¤ºä¾‹ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯å…¶ä»–æ“ä½œç³»ç»Ÿï¼Œè¯·æ ¹æ®å…¶ç‰¹å®šçš„é…ç½®æ–¹å¼è¿›è¡Œç›¸åº”çš„æ›´æ”¹ã€‚\n","permalink":"https://blog.l50.top/posts/techs/%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AEnginx%E5%A4%9A%E7%AB%99%E7%82%B9/","summary":"\u003cpre\u003e\u003ccode\u003eè¦æ‰‹åŠ¨é…ç½®NGINXå¤šç«™ç‚¹ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š\n\u003c/code\u003e\u003c/pre\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eå®‰è£…NGINXï¼šé¦–å…ˆï¼Œç¡®ä¿æ‚¨å·²ç»åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…äº†NGINXã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¿è¡Œé€‚ç”¨äºæ‚¨çš„æ“ä½œç³»ç»Ÿçš„ç›¸åº”å‘½ä»¤æ¥å®‰è£…NGINXã€‚\u003c/p\u003e","title":"æ‰‹åŠ¨é…ç½®nginxå¤šç«™ç‚¹"},{"content":"ä¸€ã€èƒŒæ™¯ Amazon Lightsailè½»é‡æœåŠ¡å™¨ï¼Œç®—æ˜¯åœ¨ä¼—å¤šå¤§å‚æœåŠ¡å™¨ä¸­æ¯”è¾ƒåˆ’ç®—çš„ä¸€æ¬¾ï¼Œ3.5ç¾åˆ€ä¸€ä¸ªæœˆå°±å¯ä»¥è·å¾—è¿™æ ·çš„é…ç½®ï¼š\n1 2 3 4 512 MB Memory 2 vCPUs Processing 20 GB SSD Storage 1 TB Transfer è¿˜å¯ä»¥é€šè¿‡åƒç çš„æ–¹å¼è·å–æ›´ä¼˜æƒ çš„ä»·æ ¼ã€‚\nä½†æ˜¯è¶…å‡ºæµé‡é™é¢åï¼Œæ¯GBæµé‡0.12ç¾é‡‘ï¼ŒåŠ ä¸ŠLightsailçš„å¸¦å®½æœ€é«˜å¯è¾¾4Gpbsï¼Œå¦‚æœä¸æ³¨æ„æµé‡è¶…å‡ºé™é¢åç»§ç»­ä½¿ç”¨å°±ä¼šå¾ˆå®¹æ˜“äº§ç”Ÿå·¨é¢çš„è´¦å•ã€‚\næ‰€ä»¥ï¼Œéœ€è¦æ‰¾ä¸€ä¸ªæ–¹å¼ï¼Œè¶…è¿‡æµé‡é™é¢åï¼Œåœæ­¢æœºå™¨çš„ä½¿ç”¨ï¼Œä»¥å…äº§ç”Ÿå·¨é¢è´¦å•ã€‚\nå…è´£å£°æ˜ï¼šæˆ‘æ˜¯æ ¹æ®MJJæä¾›çš„äºšé©¬é€Šå®˜æ–¹åšå®¢é“¾æ¥ï¼Œè®°å½•äº†ä¸‹è‡ªå·±æ­å»ºå¹¶æ”¹é€ çš„è¿‡ç¨‹ï¼Œå¹¶ä¸ä¿è¯è¯¥æ–¹å¼100%å¯ä»¥è§£å†³é—®é¢˜ï¼Œéœ€è¦è‡ªè¡ŒéªŒè¯ã€‚\näºŒã€å¤§è‡´æ€è·¯ åˆ©ç”¨Amazonçš„Lambdaå‡½æ•°è®¡ç®—ï¼ˆ100Wæ¬¡ä»¥å†…å…è´¹ï¼‰ï¼Œé…åˆAmazonæä¾›çš„å®˜æ–¹Lightsail APIï¼Œè®¾ç½®å®šæ—¶ä»»åŠ¡ï¼Œæ¯10åˆ†é’Ÿè·å–å½“å‰æµé‡é™é¢å’Œå·²ä½¿ç”¨æµé‡ï¼Œè¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœè¾¾åˆ°é™é¢çš„95%ï¼Œåˆ™å…³é—­Lightsailå®ä¾‹ï¼š\nåˆ©ç”¨ Lightsail çš„ API æ¥å£ï¼šget_instanceï¼Œè·å–è´¦å·ä¸‹åœ¨å½“å‰åŒºåŸŸé‡Œçš„æ‰€æœ‰ Lightsail å®ä¾‹ã€‚ æ ¹æ® Lightsail å®ä¾‹çš„ç±»å‹ï¼Œè·å–æ¯ä¸ªå®ä¾‹æ¯ä¸ªæœˆçš„ç½‘ç»œæµé‡é…é¢ã€‚ æ ¹æ®å®ä¾‹çš„åˆ›å»ºæ—¶é—´ï¼Œè®¡ç®—å‡ºæ¯ä¸ªå®ä¾‹åœ¨å½“å‰è¿™ä¸ªè®¡è´¹å‘¨æœŸå†…çš„æµé‡é…é¢ã€‚ é€šè¿‡ API æ¥å£ï¼šget_instance_metric_dataï¼Œè·å–æ¯ä¸ªå®ä¾‹å·²ç»ä½¿ç”¨çš„å…¥ç«™å’Œå‡ºç«™æµé‡æ€»é‡ã€‚ å¦‚æœæµé‡è¶…å‡ºå½“å‰è®¡è´¹å‘¨æœŸçš„é…é¢çš„95%ï¼Œå¹¶å…³é—­å¯¹åº”çš„ Lightsail å®ä¾‹ã€‚ é€šè¿‡ EventBridge ä»¥ cron job çš„æ–¹å¼å®šæ—¶è§¦å‘ Lambdaï¼Œè¿è¡Œæ­¤æ£€æŸ¥é€»è¾‘ã€‚ ä¼˜åŠ¿æ˜¯ä½¿ç”¨å®˜æ–¹APIè·å–æµé‡ä½¿ç”¨æƒ…å†µï¼Œç†è®ºä¸Šæ›´å‡†ç¡®ã€‚ åŠ£åŠ¿æš‚æ—¶æ²¡å‘ç°ï¼Œåç»­å‘ç°äº†å†è¡¥å……ã€‚\nä¸‰ã€è¿‡ç¨‹ 1. åˆ›å»ºLambdaå‡½æ•° åœ¨AWSæ§åˆ¶å°è¿›å…¥Lambdaå‡½æ•°é¡µé¢ï¼Œåˆ›å»ºæ–°å‡½æ•°ï¼š\nPythonè„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 import json import boto3 import calendar import os from datetime import datetime, date, time,timedelta def get_current_month_first_day_zero_time(): today = date.today() first_day = today.replace(day=1) first_day_zero_time = datetime.combine(first_day, time.min) return first_day_zero_time def get_current_month_last_day_last_time(): today = date.today() last_day = today.replace(day=calendar.monthrange(today.year, today.month)[1]) last_day_last_time = datetime.combine(last_day, time(23, 59, 59)) return last_day_last_time def stop_instance(instance_name): client = boto3.client(\u0026#39;lightsail\u0026#39;) response = client.stop_instance( instanceName=instance_name, force=True ) def list_instances(instances_list): client = boto3.client(\u0026#39;lightsail\u0026#39;) paginator = client.get_paginator(\u0026#39;get_instances\u0026#39;) # Create a PageIterator from the Paginator page_iterator = paginator.paginate() for page in page_iterator: for instance in page[\u0026#39;instances\u0026#39;]: print(instance[\u0026#39;name\u0026#39;]) instances_list.append(instance[\u0026#39;name\u0026#39;]) def get_month_dto_quota(instance_name): client = boto3.client(\u0026#39;lightsail\u0026#39;) response = client.get_instance( instanceName=instance_name ) #print(\u0026#34;response : {}\u0026#34;.format(response)) dto_quota = response[\u0026#39;instance\u0026#39;][\u0026#39;networking\u0026#39;][\u0026#39;monthlyTransfer\u0026#39;][\u0026#39;gbPerMonthAllocated\u0026#39;] current_datetime = datetime.now() instance_created_datetime = response[\u0026#39;instance\u0026#39;][\u0026#39;createdAt\u0026#39;] if (instance_created_datetime.year == current_datetime.year) and (instance_created_datetime.month == current_datetime.month): month_ts = get_current_month_last_day_last_time().timestamp() - get_current_month_first_day_zero_time().timestamp() instance_valide_ts = get_current_month_last_day_last_time().timestamp() - instance_created_datetime.timestamp() dto_quota = (instance_valide_ts/month_ts) * dto_quota print(\u0026#34;created in current month, quota: {}GB\u0026#34;.format(dto_quota)) else: dto_quota = response[\u0026#39;instance\u0026#39;][\u0026#39;networking\u0026#39;][\u0026#39;monthlyTransfer\u0026#39;][\u0026#39;gbPerMonthAllocated\u0026#39;] print(\u0026#34;created in previous month, full quota: {}GB\u0026#34;.format(dto_quota)) return dto_quota def get_instance_data_usage(instance_name, data_type): client = boto3.client(\u0026#39;lightsail\u0026#39;) current_time = datetime.utcnow() start_time = get_current_month_first_day_zero_time() end_time = get_current_month_last_day_last_time() start_time_str = start_time.strftime(\u0026#39;%Y-%m-%dT%H:%M:%SZ\u0026#39;) end_time_str = end_time.strftime(\u0026#39;%Y-%m-%dT%H:%M:%SZ\u0026#39;) response = client.get_instance_metric_data( instanceName=instance_name, metricName=data_type, period= 6 * 600 * 24, unit=\u0026#39;Bytes\u0026#39;, statistics=[ \u0026#39;Sum\u0026#39; ], startTime=start_time_str, endTime=end_time_str ) data_points = response[\u0026#39;metricData\u0026#39;] total_data_usage = sum([data_point[\u0026#39;sum\u0026#39;] for data_point in data_points]) print(\u0026#34;total {} usage: {}\u0026#34;.format(data_type, total_data_usage)) return total_data_usage def push_notification(arn, msg): sns_client = boto3.client(\u0026#39;sns\u0026#39;) print(\u0026#34;sqs arn: {}\u0026#34;.format(arn)) response = sns_client.publish( TopicArn=arn, Message=msg, Subject=\u0026#39;Lightsail NetworkOut exceeded quota \u0026#39; ) def lambda_handler(event, context): instance_name= [] list_instances(instance_name) for i in instance_name: quota = get_month_dto_quota(i) * 1000 * 1000 * 1000 total = get_instance_data_usage(i, \u0026#34;NetworkOut\u0026#34;) + get_instance_data_usage(i, \u0026#34;NetworkIn\u0026#34;) msg = f\u0026#34;instance_name: {i} \\nusage: {total} Byte \\nquota: {quota} Byte \\nusage percent: {(total/quota)*100} %\u0026#34; print(msg) if (int(quota) * 0.95) \u0026lt; int(total): print(\u0026#34;(quota * 0.95) \u0026lt; total, soforce close instance: {}\u0026#34;.format(1)) stop_instance(i) return { \u0026#39;statusCode\u0026#39;: 200, \u0026#39;body\u0026#39;: json.dumps(\u0026#39;total_data_usage from Lambda!\u0026#39;) } 2. ä¿®æ”¹å‡½æ•°è¿è¡Œé…ç½® åœ¨ä¹‹å‰åˆ›å»ºçš„Lambdaå‡½æ•°é¡µé¢ï¼Œè¿›å…¥é…ç½®â€”â€”å¸¸è§„é…ç½®â€”â€”ç¼–è¾‘ï¼š\nè°ƒå¤§å†…å­˜å’Œè¶…æ—¶æ—¶é—´ï¼š\n3. èµ‹äºˆLambdaæƒé™ åœ¨ä¹‹å‰åˆ›å»ºçš„Lambdaå‡½æ•°é¡µé¢ï¼Œè¿›å…¥é…ç½®â€”â€”æƒé™â€”â€”ç‚¹å‡»é“¾æ¥è·³è½¬è‡³IAMæƒé™ç®¡ç†é¡µé¢ï¼š\nåˆ›å»ºæ–°çš„ç­–ç•¥ï¼š\né€‰æ‹©JSONï¼Œç²˜è´´æ•°æ®ï¼Œä¿å­˜\nJSONæ•°æ®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 { \u0026#34;Version\u0026#34;: \u0026#34;2012-10-17\u0026#34;, \u0026#34;Statement\u0026#34;: [ { \u0026#34;Action\u0026#34;: [ \u0026#34;lightsail:GetInstance\u0026#34;, \u0026#34;lightsail:GetInstanceMetricData\u0026#34;, \u0026#34;lightsail:GetInstances\u0026#34;, \u0026#34;lightsail:StopInstance\u0026#34; ], \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Resource\u0026#34;: \u0026#34;*\u0026#34; } ] } ç­–ç•¥åˆ›å»ºå®Œæˆåå…³é—­IAMæƒé™é¡µé¢ï¼Œå›åˆ°Lambdaå‡½æ•°é¡µé¢ï¼Œæµ‹è¯•æ˜¯å¦æˆåŠŸï¼š\n4. åˆ›å»ºå®šæ—¶ä»»åŠ¡è§¦å‘Lambdaå‡½æ•° åœ¨Lambdaå‡½æ•°é¡µé¢ç‚¹å‡»æ·»åŠ è§¦å‘å™¨ï¼š\né€‰æ‹©EventBridgeï¼Œå¢åŠ å®šæ—¶ä»»åŠ¡ï¼Œä¿å­˜ï¼š\nè¡¨è¾¾å¼ï¼šcron(0/10 * * * ? *)\nè¿™æ—¶å°±å·²ç»åŸºæœ¬å®Œæˆé…ç½®äº†ã€‚\nLambdaå‡½æ•°æ¯10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œç¬¦åˆæ¡ä»¶å°±ä¼šè‡ªåŠ¨å…³é—­å®ä¾‹ã€‚\n5. æŸ¥çœ‹å†å²æ‰§è¡Œè®°å½• åœ¨Lambdaå‡½æ•°é¡µé¢ï¼Œé€‰æ‹©ç›‘æ§ï¼Œç‚¹å‡»æŸ¥çœ‹CloudWatch Logsè·³è½¬è‡³æ—¥å¿—é¡µé¢ã€‚\né€‰æ‹©æ—¥å¿—å°±å¯ä»¥çœ‹åˆ°æ—¥å¿—çš„è¯¦ç»†ä¿¡æ¯äº†ï¼š\nè¿™æ ·å°±å¯ä»¥æŸ¥çœ‹å†å²çš„æ‰§è¡Œç»“æœäº†ã€‚\nå››ã€å‚è€ƒèµ„æ–™ ä½¿ç”¨ Lambda ç›‘æ§ Amazon Lightsail æ•°æ®æµé‡\nå’ŒåŸæ–‡ä¸åŒçš„ç‚¹ï¼š\nåˆ é™¤äº†é€šçŸ¥éƒ¨åˆ†ï¼Œæˆ‘æ­å»ºå®Œæˆåï¼Œé€šçŸ¥ä¸èƒ½é€‰é‚®ä»¶ï¼Œå¯¹æˆ‘å°±æ²¡å•¥ç”¨å¤„äº†ã€‚ åŸæœ¬å¯¹æ¯”é€»è¾‘æ˜¯è¶…è¿‡é™é¢æ‰åœæœºï¼Œæˆ‘è°ƒæ•´ä¸ºäº†è¶…è¿‡é™é¢çš„95%å°±åœæœºï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹è„šæœ¬è¿›è¡Œè°ƒæ•´ã€‚ ","permalink":"https://blog.l50.top/posts/techs/lightsail%E8%87%AA%E5%8A%A8%E6%A3%80%E6%B5%8B%E7%94%A8%E9%87%8F%E8%BE%BE95%E8%87%AA%E5%8A%A8%E5%85%B3%E6%9C%BA/","summary":"\u003ch4 id=\"ä¸€èƒŒæ™¯\"\u003eä¸€ã€èƒŒæ™¯\u003c/h4\u003e\n\u003cp\u003eAmazon Lightsailè½»é‡æœåŠ¡å™¨ï¼Œç®—æ˜¯åœ¨ä¼—å¤šå¤§å‚æœåŠ¡å™¨ä¸­æ¯”è¾ƒåˆ’ç®—çš„ä¸€æ¬¾ï¼Œ3.5ç¾åˆ€ä¸€ä¸ªæœˆå°±å¯ä»¥è·å¾—è¿™æ ·çš„é…ç½®ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-tex\" data-lang=\"tex\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e512 MB Memory\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2 vCPUs Processing\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e20 GB SSD Storage\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e1 TB Transfer\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eè¿˜å¯ä»¥é€šè¿‡åƒç çš„æ–¹å¼è·å–æ›´ä¼˜æƒ çš„ä»·æ ¼ã€‚\u003c/p\u003e","title":"Lightsailè‡ªåŠ¨æ£€æµ‹ç”¨é‡ï¼ˆè¾¾95%è‡ªåŠ¨å…³æœº)"},{"content":"ä½¿ç”¨cronè®°å¾—è°ƒæ•´æœ¬åœ°æ—¶é—´ä¸é¢„æœŸæ—¶åŒºï¼Œä¸€èˆ¬çš„å›½å¤–VPSéƒ½æ˜¯ç¾å›½æ—¶åŒºï¼Œä½ è¦æƒ³åœ¨ä¸­å›½æ—¶é—´è¿è¡Œï¼Œä½ å¾—ä¿®æ”¹localtime çš„æ—¶åŒºä¸ºAsia/Shanghai\n1. æŸ¥çœ‹VPSæ—¶é—´ï¼Œæœ€åçš„+0800å°±æ˜¯æ—¶åŒºã€‚ # date -R Mon, 27 Feb 2012 17:32:07 +0800\nä¸€èˆ¬æ¥è¯´æ—¶é—´æœ‰è¯¯çš„VPSéƒ½ä¸åœ¨ä¸œå…«åŒºï¼Œæ‰€ä»¥å¦‚æœå‘ç°ä½ çš„VPSæ—¶åŒºä¸å¯¹ï¼Œé¦–å…ˆè¦åšçš„å°±æ˜¯æ ¡æ­£æ—¶åŒº ï¼ˆå¦‚æœVPSæ˜¯xençš„å°±éœ€è¦å…ˆæ‰§è¡Œ echo 1 \u0026gt; /proc/sys/xen/independent_wallclockï¼‰\n2. æ ¡æ­£æ—¶åŒº # rm -rf /etc/localtime # ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\næ ¡æ­£ä¹‹åå†date -Rä¸€æ¬¡ï¼Œå¦‚æœæ—¶é—´å¯¹äº†é‚£å°±OKäº†ï¼ˆé€šå¸¸æƒ…å†µopenvz VPSåªè¦ä¿®æ”¹æ—¶åŒºå°±å¯ä»¥ï¼‰ï¼Œåä¹‹ç»§ç»­åŒæ­¥æ—¶é—´ã€‚\nå¦‚æœæ‚¨æƒ³æ‰‹åŠ¨ä¿®æ”¹/etc/localtimeæ–‡ä»¶æ¥æ›´æ”¹æ—¶åŒºè®¾ç½®ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š\næ‰“å¼€ç»ˆç«¯å¹¶ä»¥rootç”¨æˆ·èº«ä»½ç™»å½•ã€‚\nå¤‡ä»½å½“å‰çš„/etc/localtimeæ–‡ä»¶ï¼Œä»¥é˜²æ­¢æ„å¤–æ›´æ”¹ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå¤‡ä»½ï¼š\n1 sudo cp /etc/localtime /etc/localtime.bak ç¡®å®šæ‚¨æƒ³è¦è®¾ç½®çš„æ—¶åŒºæ–‡ä»¶çš„è·¯å¾„ã€‚åœ¨ä¸­å›½ï¼Œé€šå¸¸ä½¿ç”¨/usr/share/zoneinfo/Asia/Shanghaiä½œä¸ºæ—¶åŒºæ–‡ä»¶ã€‚æ‚¨å¯ä»¥æ ¹æ®è‡ªå·±æ‰€åœ¨çš„åŸå¸‚é€‰æ‹©ç›¸åº”çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åœ¨åŒ—äº¬ï¼Œå¯ä»¥ä½¿ç”¨/usr/share/zoneinfo/Asia/Shanghaiã€‚\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†æ‰€é€‰çš„æ—¶åŒºæ–‡ä»¶å¤åˆ¶åˆ°/etc/localtimeï¼š\n1 sudo cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime å®Œæˆåï¼Œæ‚¨å¯ä»¥éªŒè¯æ—¶åŒºè®¾ç½®æ˜¯å¦å·²æ›´æ”¹ã€‚å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥ï¼š\n1 date å¦‚æœæ—¶åŒºè®¾ç½®å·²æ­£ç¡®æ›´æ”¹ï¼Œè¾“å‡ºçš„æ—¶é—´å’Œæ—¶åŒºåº”ä¸æ‚¨æ‰€é€‰æ‹©çš„åŸå¸‚ç›¸åŒ¹é…ã€‚\nè¯·æ³¨æ„ï¼Œæ‰‹åŠ¨ä¿®æ”¹/etc/localtimeæ–‡ä»¶æ˜¯ä¸€ç§æ›´æ”¹æ—¶åŒºè®¾ç½®çš„æ–¹æ³•ï¼Œä½†å¹¶ä¸æ˜¯å®˜æ–¹æ¨èçš„æ–¹å¼ã€‚ä½¿ç”¨å®˜æ–¹æä¾›çš„å·¥å…·å¦‚dpkg-reconfigureæ¥æ›´æ”¹æ—¶åŒºè®¾ç½®æ›´ä¸ºå¯é å’Œæ¨èã€‚å¦‚æœæ‚¨ä¹‹å‰å°è¯•ä½¿ç”¨dpkg-reconfigureå‘½ä»¤æ—¶æœªèƒ½æˆåŠŸæ›´æ”¹æ—¶åŒºï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–é—®é¢˜å­˜åœ¨ï¼Œå»ºè®®ä»”ç»†æ£€æŸ¥å’Œæ’é™¤å…¶ä»–å¯èƒ½çš„åŸå› ã€‚\n","permalink":"https://blog.l50.top/posts/techs/%E4%BD%BF%E7%94%A8cron%E8%87%AA%E5%8A%A8%E5%8C%96%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B/","summary":"\u003cp\u003eä½¿ç”¨cronè®°å¾—è°ƒæ•´æœ¬åœ°æ—¶é—´ä¸é¢„æœŸæ—¶åŒºï¼Œä¸€èˆ¬çš„å›½å¤–VPSéƒ½æ˜¯ç¾å›½æ—¶åŒºï¼Œä½ è¦æƒ³åœ¨ä¸­å›½æ—¶é—´è¿è¡Œï¼Œä½ å¾—ä¿®æ”¹localtime çš„æ—¶åŒºä¸ºAsia/Shanghai\u003c/p\u003e","title":"ä½¿ç”¨cronè‡ªåŠ¨åŒ–éœ€è¦æ³¨æ„çš„äº‹"},{"content":"åœ¨ Debian 12 ä¸Šå®‰è£… MariaDB 10.11 1.åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹è¿°å‘½ä»¤æ›´æ–°ç³»ç»Ÿï¼š\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade 2.åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹è¿°å‘½ä»¤å®‰è£…MariaDB 10.11ï¼š\n1 sudo apt install mariadb-server 3.å®Œæˆåå¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥ä¸‹è¿°å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬ï¼š\n1 mariadb --version 4.åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹è¿°å‘½ä»¤è¿›è¡Œå®‰å…¨è®¾ç½®ï¼š\n1 mysql_secure_installation 5.ç»ˆç«¯ä¼šç›¸ç»§å‡ºç°å¦‚ä¸‹æç¤ºï¼ŒæŒ‰éœ€è¦é€‰æ‹©ï¼Œä¹Ÿå¯ä»¥ä¸€è·¯é€‰æ‹© Y ï¼š\n1 2 3 4 5 Set root password? [Y/n] y #è¿™é‡Œä¼šè¦æ±‚è¾“å…¥å¯†ç  Remove anonymous users? [Y/n] y Disallow root login remotely? [Y/n] y Remove test database and access to it? [Y/n] y Reload privilege tables now? [Y/n] y 6.å®Œæˆä¸Šè¿°é€‰é¡¹ï¼ŒMariaDB 10.11 å³å·²å®‰è£…å®Œæˆï¼Œè€Œä¸”é€šå¸¸æƒ…å†µä¸‹å·²ç»è‡ªåŠ¨å¯åŠ¨ã€‚ä¹Ÿå¯ä»¥åœ¨ç»ˆç«¯è¿è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨ï¼š\n1 sudo systemctl start mariad 7.åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹è¿°å‘½ä»¤è¿æ¥ MariaDBï¼Œæˆ–é€šè¿‡ç¬¬ä¸‰æ–¹å·¥å…·è¿æ¥ï¼š\n1 mysql -u root -p æŒ‰æç¤ºè¾“å…¥å¯†ç å³å¯è¿æ¥ã€‚\n","permalink":"https://blog.l50.top/posts/techs/debian12%E5%AE%89%E8%A3%85mariadb_10.11/","summary":"\u003ch1 id=\"åœ¨-debian-12-ä¸Šå®‰è£…-mariadb-1011\"\u003eåœ¨ Debian 12 ä¸Šå®‰è£… MariaDB 10.11\u003c/h1\u003e\n\u003chr\u003e\n\u003cp\u003e1.åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹è¿°å‘½ä»¤æ›´æ–°ç³»ç»Ÿï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt update \u0026amp;\u0026amp; sudo apt upgrade\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2.åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹è¿°å‘½ä»¤å®‰è£…MariaDB 10.11ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install mariadb-server\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3.å®Œæˆåå¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥ä¸‹è¿°å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬ï¼š\u003c/p\u003e","title":"Debian12å®‰è£…MariaDB_10.11"},{"content":"è¦åœ¨ Debian ä¸­ä¸ºæ‚¨çš„ ens33 ç½‘ç»œæ¥å£è®¾ç½®å›ºå®š IPï¼Œæ‚¨éœ€è¦ç¼–è¾‘ /etc/network/interfaces æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹é…ç½®ï¼Œæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„ç½‘ç»œç¯å¢ƒè¿›è¡Œä¿®æ”¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 # The loopback network interface auto lo iface lo inet loopback # The primary network interface allow-hotplug ens33 iface ens33 inet static address 192.168.152.50 netmask 255.255.255.0 gateway 192.168.152.2 dns-nameservers 192.168.152.2 åœ¨ä¸Šè¿°é…ç½®ä¸­ï¼š\naddress æ˜¯æ‚¨æƒ³è¦è®¾ç½®çš„é™æ€ IP åœ°å€ã€‚ netmask æ˜¯æ‚¨çš„ç½‘ç»œæ©ç ã€‚ gateway æ˜¯æ‚¨çš„ç½‘å…³åœ°å€ã€‚ dns-nameservers æ˜¯æ‚¨çš„ DNS æœåŠ¡å™¨åœ°å€ã€‚ ç¼–è¾‘å®Œ /etc/network/interfaces æ–‡ä»¶åï¼Œæ‚¨éœ€è¦é‡å¯ç½‘ç»œæœåŠ¡ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥é‡å¯ç½‘ç»œæœåŠ¡ï¼š\n1 sudo /etc/init.d/networking restart ","permalink":"https://blog.l50.top/posts/techs/vmware%E6%89%8B%E5%8A%A8%E4%BF%AE%E6%94%B9%E7%89%B9%E5%AE%9A%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%BB%98%E8%AE%A4%E5%88%86%E9%85%8D%E7%9A%84ip%E5%9C%B0%E5%9D%80/","summary":"\u003cp\u003eè¦åœ¨ Debian ä¸­ä¸ºæ‚¨çš„ \u003ccode\u003eens33\u003c/code\u003e ç½‘ç»œæ¥å£è®¾ç½®å›ºå®š IPï¼Œæ‚¨éœ€è¦ç¼–è¾‘ \u003ccode\u003e/etc/network/interfaces\u003c/code\u003e æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹é…ç½®ï¼Œæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„ç½‘ç»œç¯å¢ƒè¿›è¡Œä¿®æ”¹ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# The loopback network interface\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eauto lo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiface lo inet loopback\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# The primary network interface\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eallow-hotplug ens33\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiface ens33 inet static\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    address 192.168.152.50\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    netmask 255.255.255.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    gateway 192.168.152.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    dns-nameservers 192.168.152.2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eåœ¨ä¸Šè¿°é…ç½®ä¸­ï¼š\u003c/p\u003e","title":"Vmwareæ‰‹åŠ¨ä¿®æ”¹ç‰¹å®šè™šæ‹Ÿæœºé»˜è®¤åˆ†é…çš„IPåœ°å€"},{"content":"è‡ªä»2016å¹´å…¥å‘äº†æ–°æµ·è¯šçš„ç¬¬ä¸€éƒ¨ç”µå½±ï¼Œã€Šä½ çš„åå­—ã€‹ä¹‹åï¼Œå¯¹äºæ–°æµ·è¯šçš„ç”µå½±æˆ‘æ˜¯ä¸€éƒ¨ä¸è½çš„çœ‹å®Œäº†ï¼Œ2016å¹´é‚£éƒ¨åˆ’æ—¶ä»£çš„ä½œå“ï¼Œã€Šä½ çš„åå­—ã€‹å®å±è®©æˆ‘å°è±¡æ·±åˆ»ï¼Œç¬¬ä¸€éçœ‹çš„æ—¶å€™æ²¡çœ‹æ˜ç™½ï¼Œåœ¨åæ¥çš„å‡ å¹´ä¸­é™†é™†ç»­ç»­çœ‹äº†ä¸ä¸‹ä¸‰éï¼Œæœ€åçœ‹æ˜ç™½äº†ï¼Œæ–°æµ·è¯šä½œä¸ºç»†èŠ‚ç‹‚é­”è¿™ä»¶äº‹æ˜¯çœŸçš„ç¦»è°±ã€‚\nä¸­é—´2019å¹´çš„å¤©æ°”ä¹‹å­ï¼Œç”±äºä¸€äº›åŸå› æ²¡èƒ½çœ‹åˆ°é¦–æ˜ ï¼Œåé¢åœ¨å®¶é‡Œè¡¥çœ‹äº†çœŸÂ·4Kè“å…‰åŸç›˜ï¼Œä¹‹åï¼Œå¯¹äº2022å¹´çš„æ–°ç”µå½±æ›´æ˜¯æ†§æ†¬ï¼Œä½†æ˜¯ç”±äºä¸€äº›åŸå› ï¼Œæ–°æµ·è¯šçš„ç”µå½±ä»2022æ¨è¿Ÿåˆ°äº†2023ï¼Œä½†æ˜¯è¿™å¹¶ä¸å½±å“æˆ‘è¿˜æ˜¯æƒ³å»çœ‹çš„å¿ƒï¼Œè€Œä»Šå¹´ï¼Œæœ‰å¹¸é‚€è¯·åˆ°äº†ä¸€ä¸ªå‚»derä¸€èµ·å»çœ‹ã€‚\nä»¥ä¸‹æ˜¯æ— æ„ï¼ˆæˆ–è®¸æ˜¯æœ‰æ„çš„å‘¢ï¼Ÿï¼‰æ‹åˆ°çš„å›¾ç‰‡ï¼š\nå½“äº‹äººè¡¨ç¤ºä¸è®©ï¼Œä½†æ˜¯æˆ‘åœ¨æ— æ„é—´(ä¸€å®šæ˜¯æ— æ„é—´æ‹åˆ°çš„)æ‹åˆ°äº†ä¸€å¼ å½“äº‹äºº!\næ­¤æ—¶åœ¨ç­‰å¾…æ£€ç¥¨ing\nç»ˆäºå¼€å§‹äº†ï¼Œæ˜¯æ–°æµ·è¯šçš„æ–°ç”µå½±ï¼\nç”»è´¨è¿˜æ˜¯é‚£ä¹ˆæƒŠè‰³\nä¸è¿‡å…¨ç¯‡ä¸­ç”·ä¸»çœŸèº«å‡ºåœºçš„æˆä»½å¤ªå°‘äº†ï¼Œå»ºè®®æ”¹åä¸ºä½ çš„åå­—ç»­ä½œÂ·ä½ çš„æ¤…å­\nå†™åœ¨æœ€åï¼š\nèš“å„ï¼Œå¾€ç•Œï¼ŒåºŸå¢Ÿï¼Œåœ°éœ‡è¿™äº›ä¸œè¥¿ã€‚æŒ‰æˆ‘çš„ç†è§£å°±æ˜¯ï¼Œç»å†è¿‡çš„ï¼Œä¸ç®¡å¥½çš„åçš„äº‹æƒ…ï¼Œéƒ½ä¼šç•™ä¸‹ç—•è¿¹ï¼Œè¿™äº›ä¸œè¥¿éƒ½æ˜¯æœ‰èƒ½é‡çš„ã€‚ç§¯æ”’å¤šäº†ï¼Œå°±çˆ†å‘äº†ã€‚æ‰€ä»¥äººè·Ÿç€æ—¶é—´ä¸åœå‰è¿›çš„åŒæ—¶ï¼Œåº”è¯¥ä¹ŸæŠŠè¿™äº›ä¸œè¥¿å¤„ç†å¥½ï¼Œæ¶ˆåŒ–å¥½ï¼Œåœæ­¢å†…è€—ã€‚é”ä¸Šé—¨ï¼Œèµ°å‡ºå»ã€‚\nã™ãšã‚ç›´è¯‘çš„æ„æ€æ˜¯éº»é›€ï¼Œäººç±»åœ¨è‡ªç„¶ç¾å®³é¢å‰æ¸ºå°å¦‚éº»é›€ï¼Œä½ çš„åå­—é¢å¯¹ç¾éš¾é€‰æ‹©äº†å»æ”¹å˜æœªæ¥ï¼Œå¤©æ°”ä¹‹å­é¢å¯¹ç¾éš¾é‡æ–°é€‰æ‹©äº†äººç”Ÿï¼Œè€Œåˆ°äº†é“ƒèŠ½æ˜¯æ¥å—ç°å®ï¼Œé¢å¯¹ç¾éš¾ã€‚ç¼…æ€€é€è€…ï¼Œå¸¦ç€å¸Œæœ›å¥½å¥½æ´»ä¸‹å»ï¼Œå°±åƒé“ƒèŠ½å¯¹å°é“ƒèŠ½æ‰€è¯´çš„â€œæœªæ¥å¹¶ä¸å¯æ€•â€è¿™åº”è¯¥å°±æ˜¯æ–°æµ·å¯¼æƒ³è¡¨è¾¾çš„å§ï¼Œå¸Œæœ›æˆ‘ä»¬æ¯ä¸ªäººéƒ½èƒ½ä¸»åŠ¨å»è¿æ¥æ˜å¤©ï¼\nä»¥å‰çœ‹è¯šå“¥çš„ç”µå½±æ€»è§‰å¾—ä¸»è§’çš„çˆ±æƒ…æ¥çš„çªç„¶æ¥çš„è‰ç‡ ç°åœ¨æ‰çŸ¥é“çˆ±æƒ…å°±æ˜¯çªå¦‚å…¶æ¥ä¸è®²é“ç†çš„ å–œæ¬¢çš„äººéƒ½æ˜¯çªç„¶é‡è§çš„\nç”µå½±çœ‹å®Œäº†ï¼Œæœ€åçš„ç‹¬ç™½åƒæ˜¯åœ¨å‘Šè¯«æˆ‘ï¼Œä¸€åˆ‡éƒ½åˆ°æ”¾ä¸‹çš„æ—¶å€™äº†ï¼Œå¥½å¥½ç”Ÿæ´»ï¼Œä¼šæ›´å¥½çš„ï¼Œè‡ªå·±ä¹Ÿä¼šæˆä¸ºæ›´å¥½çš„äºº\n2022ã€Šé“ƒèŠ½æˆ·ç¼”ã€‹ 2019ã€Šå¤©æ°”ä¹‹å­ã€‹ 2016ã€Šä½ çš„åå­—ã€‹ 2013ã€Šè¨€å¶ä¹‹åº­ã€‹ 2011ã€Šè¿½é€ç¹æ˜Ÿçš„å­©å­ã€‹ 2007ã€Šç§’é€Ÿ5å˜ç±³ã€‹ 2004ã€Šäº‘çš„å½¼ç«¯ï¼Œçº¦å®šçš„åœ°æ–¹ã€‹ æ„Ÿè°¢è¯šå“¥çš„é™ªä¼´ï¼\n","permalink":"https://blog.l50.top/posts/life/%E6%96%B0%E6%B5%B7%E8%AF%9A%E7%9A%84%E4%B8%89%E5%B9%B4%E4%B9%8B%E7%BA%A6-%E9%93%83%E8%8A%BD%E4%B9%8B%E6%97%85/","summary":"\u003cp\u003eè‡ªä»2016å¹´å…¥å‘äº†æ–°æµ·è¯šçš„ç¬¬ä¸€éƒ¨ç”µå½±ï¼Œã€Šä½ çš„åå­—ã€‹ä¹‹åï¼Œå¯¹äºæ–°æµ·è¯šçš„ç”µå½±æˆ‘æ˜¯ä¸€éƒ¨ä¸è½çš„çœ‹å®Œäº†ï¼Œ2016å¹´é‚£éƒ¨åˆ’æ—¶ä»£çš„ä½œå“ï¼Œã€Šä½ çš„åå­—ã€‹å®å±è®©æˆ‘å°è±¡æ·±åˆ»ï¼Œç¬¬ä¸€éçœ‹çš„æ—¶å€™æ²¡çœ‹æ˜ç™½ï¼Œåœ¨åæ¥çš„å‡ å¹´ä¸­é™†é™†ç»­ç»­çœ‹äº†ä¸ä¸‹ä¸‰éï¼Œæœ€åçœ‹æ˜ç™½äº†ï¼Œæ–°æµ·è¯šä½œä¸ºç»†èŠ‚ç‹‚é­”è¿™ä»¶äº‹æ˜¯çœŸçš„ç¦»è°±ã€‚\u003c/p\u003e","title":"æ–°æµ·è¯šçš„ä¸‰å¹´ä¹‹çº¦ é“ƒèŠ½ä¹‹æ—…"},{"content":"ä¸€ï¼‰ACMEå®‰è£… 1 curl https://get.acme.sh | sh å®‰è£…ç¨‹åºä¼šè‡ªåŠ¨åšä»¥ä¸‹æ“ä½œï¼š\nè‡ªåŠ¨æŠŠ acme.sh å®‰è£…åˆ°ä½ çš„ home çš„.acme.shç›®å½•ä¸‹ï¼Œå³~/.acme.sh/ è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª bash çš„ alias, æ–¹ä¾¿ä½ çš„ä½¿ç”¨: alias acme.sh=~/.acme.sh/acme.sh è‡ªåŠ¨ä¸ºä½ åˆ›å»º cronjob, æ¯å¤© 0:00 ç‚¹è‡ªåŠ¨æ£€æµ‹æ‰€æœ‰çš„è¯ä¹¦, å¦‚æœå¿«è¿‡æœŸäº†, éœ€è¦æ›´æ–°, åˆ™ä¼šè‡ªåŠ¨æ›´æ–°è¯ä¹¦. ï¼ˆäºŒï¼‰æ›´æ”¹é»˜è®¤è¯ä¹¦æœºæ„ 1 acme.sh --set-default-ca --server letsencrypt acmeè¢«ZeroSSLæ”¶è´­ï¼Œå…¶é»˜è®¤çš„è¯ä¹¦æ–¹å¼ä¸ºZeroSSLï¼Œä½†æ­¤è¯ä¹¦ç”Ÿæˆæ—¶ä¼šæºå¸¦é‚®ç®±ï¼Œå› æ­¤æ›´æ¢ä¸ºletsencryptã€‚\nå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨ç”Ÿæˆè¯ä¹¦æ—¶åŠ ä¸€ä¸ª--serverå‚æ•°æ¥å†³å®šç”Ÿæˆä»€ä¹ˆè¯ä¹¦\n1 --server letsencrypt ï¼ˆä¸‰ï¼‰ç”Ÿæˆè¯ä¹¦ ä½¿ç”¨acme.sh --issueå‘½ä»¤ç”Ÿæˆè¯ä¹¦ï¼Œä½†ç”Ÿæˆè¯ä¹¦çš„åŒæ—¶ä¼šè¿›è¡ŒåŸŸåçš„æ‰€æœ‰æƒçš„éªŒè¯ã€‚ acme.sh æœ‰ä¸¤ç§æ–¹å¼éªŒè¯ï¼šhttp å’Œ dns éªŒè¯ã€‚\næ³¨æ„ï¼šå¦‚æœéœ€è¦ç”Ÿæˆæ³›åŸŸåï¼ˆ*.a.comï¼‰çš„è¯ä¹¦ï¼Œä¸èƒ½ä½¿ç”¨HTTPè®¤è¯åŸŸåï¼Œéœ€è¦æ”¹ç”¨DNSè®¤è¯çš„æ–¹å¼\nDNS éªŒè¯æ–¹å¼ï¼ˆæ¨è,æ‰‹åŠ¨ä¹Ÿå¯ï¼Œä½†æ˜¯ä½œè€…ä¸æƒ³æ‰‹åŠ¨.jpgï¼‰ éœ€è¦åœ¨åŸŸåä¸Šæ·»åŠ ä¸€æ¡ txt è§£æè®°å½•, éªŒè¯åŸŸåæ‰€æœ‰æƒ\næ–¹å¼1ï¼šæ‰‹åŠ¨æ·»åŠ è®°å½• a. ç”Ÿæˆtxtè§£æå†…å®¹\n1 2 acme.sh --issue --dns -d mydomain.com \\ --yes-I-know-dns-manual-mode-enough-go-ahead-please ä»¥ä¸Šmydomain.comåªæ˜¯æµ‹è¯•åŸŸåï¼Œå¦‚æœå¤šä¸ªåŸŸåï¼Œåˆ™éœ€å¤šæ¬¡ä½¿ç”¨-dé…ç½®ï¼Œå¦‚-d www.a.com -d img.a.com\nb. æŠŠtxtè§£ææ·»åŠ åˆ°åŸŸåç®¡ç†é¢æ¿ä¸­\nc. é‡æ–°ç”Ÿæˆè¯ä¹¦\n1 2 acme.sh --renew -d mydomain.com \\ --yes-I-know-dns-manual-mode-enough-go-ahead-please æ³¨æ„ï¼Œé‡æ–°ç”Ÿæˆä½¿ç”¨çš„æ˜¯renewå‚æ•°ï¼ŒæŠŠç”Ÿæˆtxtè§£æå†…å®¹å‘½ä»¤çš„issueæ”¹ä¸ºrenew\næ–¹å¼2ï¼šåŸŸåæä¾›å•†apiè‡ªåŠ¨è§£æ dns æ–¹å¼çš„çœŸæ­£å¼ºå¤§ä¹‹å¤„åœ¨äºå¯ä»¥ä½¿ç”¨åŸŸåè§£æå•†æä¾›çš„ api è‡ªåŠ¨æ·»åŠ  txt è®°å½•å®ŒæˆéªŒè¯.\na. åœ¨åŸŸåæä¾›å•†ä¸­ï¼Œç”Ÿæˆä½ çš„ api id å’Œ api keyå¹¶è®°å½•\nb. å¼•å…¥api idå’Œkeyï¼Œä»¥dnspodä¸ºä¾‹\n1 2 export DP_Id=\u0026#34;1234\u0026#34; export DP_Key=\u0026#34;sADDsdasdgdsf\u0026#34; ä¸åŒæä¾›å•†ï¼ŒAPIå‚æ•°å€¼å„ä¸åŒï¼Œå¯å‚è€ƒä¸‹é¢çš„è¡¨æ ¼ï¼šè‡ªåŠ¨ DNS API é›†æˆ\nc. ç”Ÿæˆè¯ä¹¦\n1 acme.sh --issue --dns dns_dp -d aa.com -d www.aa.com --dnsçš„é…ç½®å€¼ä¹Ÿæ˜¯æ ¹æ®åŸŸåæä¾›å•†æ¥å†³å®šï¼Œdns_dpè¡¨ç¤ºdnspodã€‚æ›´å¤šå‚æ•°å€¼å¯çœ‹ä¸‹æ–¹è¡¨æ ¼\nè¡¨ï¼šè‡ªåŠ¨ DNS API é›†æˆ\næœåŠ¡å•†åç§° æœåŠ¡å•†ç®€ç§° æ‰€éœ€APIå‚æ•° è·å–APIå‚æ•°åœ°å€ cloudxns cx export CX_Key=\u0026quot;123456\u0026quot; export CX_Secret=\u0026quot;abcdef\u0026quot; ç‚¹å‡»è®¿é—® dnspod.cn dp export DP_Id=\u0026quot;123456\u0026quot; export DP_Key=\u0026quot;abcdef\u0026quot; ç‚¹å‡»è®¿é—® aliyun ali export Ali_Key=\u0026quot;123456\u0026quot; export Ali_Secret=\u0026quot;abcdef\u0026quot; ç‚¹å‡»è®¿é—® cloudflare cf export CF_Key=\u0026quot;123456\u0026quot; export CF_Email=\u0026quot;abc@example.com\u0026quot; ç‚¹å‡»è®¿é—® linode linode export LINODE_API_KEY=\u0026quot;123456\u0026quot; ç‚¹å‡»è®¿é—® he he export HE_Username=\u0026quot;username\u0026quot; export HE_Password=\u0026quot;password\u0026quot; heçš„ç”¨æˆ·åå¯†ç  digitalocean dgon export DO_API_KEY=\u0026quot;123456\u0026quot; ç‚¹å‡»è®¿é—® namesilo namesilo export Namesilo_Key=\u0026quot;123456\u0026quot; ç‚¹å‡»è®¿é—® aws aws export AWS_ACCESS_KEY_ID=123456 export AWS_SECRET_ACCESS_KEY=abcdef ç‚¹å‡»è®¿é—® namecom namecom export Namecom_Username=\u0026quot;username\u0026quot; export Namecom_Token=\u0026quot;123456\u0026quot; ç‚¹å‡»è®¿é—® freedns freedns export FREEDNS_User=\u0026quot;username\u0026quot; export FREEDNS_Password=\u0026quot;password\u0026quot; freednsçš„ç”¨æˆ·åå¯†ç  godaddy gd export GD_Key=\u0026quot;123456\u0026quot; export GD_Secret=\u0026quot;abcdef\u0026quot; ç‚¹å‡»è®¿é—® yandex yandex export PDD_Token=\u0026quot;abcdef\u0026quot; ç‚¹å‡»è®¿é—® æ›´å¤šdnsapiçš„ä½¿ç”¨ï¼Œå¯ä»¥æŸ¥çœ‹æ–‡æ¡£\nï¼ˆå››ï¼‰copy/å®‰è£… è¯ä¹¦ é»˜è®¤ç”Ÿæˆçš„è¯ä¹¦éƒ½æ”¾åœ¨å®‰è£…ç›®å½•ä¸‹: ~/.acme.sh/ï¼Œä½†æ˜¯ä¸è¦åœ¨webæœåŠ¡å™¨ä¸­ç›´æ¥å¼•ç”¨ç›®å½•ä¸‹çš„è¯ä¹¦æ–‡ä»¶ï¼Œä¹Ÿä¸è¦æ‰‹åŠ¨æ¥æ‹·è´è¯ä¹¦æ–‡ä»¶åˆ°å…·ä½“çš„webæœåŠ¡å™¨ä¸­ï¼Œæ‰‹åŠ¨æ‹·è´ä¼šå¯¼è‡´ä¹‹åæ›´æ–°è¯ä¹¦æµç¨‹ä¸èƒ½å®Œå…¨è‡ªåŠ¨ã€‚\næ­£ç¡®æ–¹å¼æ˜¯ä½¿ç”¨acme.shçš„å®‰è£…è¯ä¹¦å‘½ä»¤ï¼Œacme.shè‡ªåŠ¨æ‹·è´è¯ä¹¦æ–‡ä»¶åˆ°å…·ä½“ç›®å½•ä¸­ï¼Œæ‹·è´å‘½ä»¤ä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œä¹‹åè‡ªåŠ¨æ›´æ–°è¯ä¹¦æµç¨‹ä¹Ÿä¼šæ‰§è¡Œæ­¤æ‹·è´æ­¥éª¤ï¼Œä»è€Œå®ç°æ›´æ–°è¯ä¹¦æµç¨‹çš„å®Œå…¨è‡ªåŠ¨åŒ–ã€‚\næ ¼å¼ä¾‹å­å¦‚ä¸‹ï¼š\n1 2 3 4 5 acme.sh --install-cert -d xxx \\ --cert-file xxx \\ --key-file xxx \\ --fullchain-file xxx\\ --reloadcmd xxx æ ¹æ®webæœåŠ¡å™¨éœ€è¦çš„æ–‡ä»¶æŒ‰éœ€å¼•å…¥å¯¹åº”çš„å‚æ•°ï¼Œreloadcmdå®šä¹‰è¯ä¹¦æ›´æ–°åé‡å¯å¯¹åº”çš„webæœåŠ¡å‘½ä»¤ã€‚\nä»¥nginxä¸ºä¾‹ï¼š\n1 2 3 4 acme.sh --install-cert -d www.a.com -d img.a.com \\ --key-file /etc/nginx/cert_file/key.pem \\ --fullchain-file /etc/nginx/cert_file/fullchain.pem \\ --reloadcmd \u0026#34;service nginx force-reload\u0026#34; ï¼ˆäº”ï¼‰webæœåŠ¡ä½¿ç”¨è¯ä¹¦ é€šè¿‡ä¸Šä¸€æ­¥å®‰è£…è¯ä¹¦ï¼Œå·²ç»æŠŠè¯ä¹¦æ‹·è´åˆ°ç›®æ ‡çš„ç›®å½•ï¼Œæ¥ä¸‹æ¥å°±æ˜¯åœ¨webæœåŠ¡ä¸­ä½¿ç”¨è¯ä¹¦å³å¯ã€‚\nä»¥nginxä¸ºä¾‹ï¼š\n1 2 3 4 5 6 7 ... server { listen 443 ssl; ssl_certificate /etc/nginx/cert_file/fullchain.pem; ssl_certificate_key /etc/nginx/cert_file/key.pem; # ... } æ›´æ–°è¯ä¹¦ ç›®å‰è¯ä¹¦åœ¨ 60 å¤©ä»¥åä¼šè‡ªåŠ¨æ›´æ–°ï¼Œä½ æ— éœ€ä»»ä½•æ“ä½œï¼Œå› ä¸ºåœ¨acme.shå®‰è£…æ—¶ï¼Œå·²ç»æŠŠç›¸å…³çš„è‡ªåŠ¨æ›´æ–°ç¨‹åºå†™å…¥åˆ°crontabä¸­ï¼Œå¦‚æœæƒ³è¦æŸ¥çœ‹ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤ï¼š\n1 crontab -l è¾“å‡ºå†…å®¹åŒ…å«ä¸€ä¸ªè‡ªåŠ¨æ›´æ–°ç¨‹åºï¼Œå¤§è‡´å†…å®¹å¦‚ä¸‹ï¼š\n1 56 * * * * \u0026#34;/root/.acme.sh\u0026#34;/acme.sh --cron --home \u0026#34;/root/.acme.sh\u0026#34; \u0026gt; /dev/null åœæ­¢è‡ªåŠ¨æ›´æ–° 1 acme.sh --remove -d example.com æˆ–è€…æ‰‹åŠ¨åœ¨~/.acme.sh/ç›®å½•ä¸‹åˆ é™¤å¯¹åº”çš„åŸŸåç›®å½•ï¼Œå¦‚~/.acme.sh/a.comã€‚\n","permalink":"https://blog.l50.top/posts/techs/%E4%BD%BF%E7%94%A8acme.sh%E7%94%B3%E8%AF%B7%E5%B9%B6%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9Fssl%E8%AF%81%E4%B9%A6/","summary":"\u003ch2 id=\"ä¸€acmeå®‰è£…\"\u003eä¸€ï¼‰ACMEå®‰è£…\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecurl  https://get.acme.sh | sh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eå®‰è£…ç¨‹åºä¼šè‡ªåŠ¨åšä»¥ä¸‹æ“ä½œï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eè‡ªåŠ¨æŠŠ acme.sh å®‰è£…åˆ°ä½ çš„ \u003cstrong\u003ehome\u003c/strong\u003e çš„\u003ccode\u003e.acme.sh\u003c/code\u003eç›®å½•ä¸‹ï¼Œå³\u003ccode\u003e~/.acme.sh/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª bash çš„ alias, æ–¹ä¾¿ä½ çš„ä½¿ç”¨: \u003ccode\u003ealias acme.sh=~/.acme.sh/acme.sh\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eè‡ªåŠ¨ä¸ºä½ åˆ›å»º cronjob, æ¯å¤© 0:00 ç‚¹è‡ªåŠ¨æ£€æµ‹æ‰€æœ‰çš„è¯ä¹¦, å¦‚æœå¿«è¿‡æœŸäº†, éœ€è¦æ›´æ–°, åˆ™ä¼šè‡ªåŠ¨æ›´æ–°è¯ä¹¦.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"äºŒæ›´æ”¹é»˜è®¤è¯ä¹¦æœºæ„\"\u003eï¼ˆäºŒï¼‰æ›´æ”¹é»˜è®¤è¯ä¹¦æœºæ„\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eacme.sh --set-default-ca  --server  letsencrypt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eacmeè¢«ZeroSSLæ”¶è´­ï¼Œå…¶é»˜è®¤çš„è¯ä¹¦æ–¹å¼ä¸ºZeroSSLï¼Œä½†æ­¤è¯ä¹¦ç”Ÿæˆæ—¶ä¼šæºå¸¦é‚®ç®±ï¼Œå› æ­¤æ›´æ¢ä¸ºletsencryptã€‚\u003c/p\u003e","title":"ä½¿ç”¨acme.shç”³è¯·å¹¶è‡ªåŠ¨ç»­æœŸSSLè¯ä¹¦"},{"content":"å½“ä½ åœ¨Windowsä¸‹æ­å»ºhugoæ—¶ä½ å¿…é¡»é¦–å…ˆå°†gité…ç½®ä¸­çš„è‡ªåŠ¨åˆ‡æ¢æ”¹ä¸ºfalseï¼Œå¦‚æœä¸è°ƒæ•´è¯¥é¡¹ï¼Œä½ é€šè¿‡Windowsä¸Šä¼ çš„hugoåˆ°github pageså°†ä¼šæ ·å¼ä¸å¯¹ï¼Œå³ä½¿ä½ åœ¨æœ¬åœ°é¢„è§ˆçš„æ˜¯æ­£ç¡®çš„ä¸»é¢˜ï¼Œä½ åº”å½“åœ¨æ“ä½œä¹‹å‰ä½¿ç”¨ï¼šgit config core.autocrlf falseã€‚\nè‡³äºä¸ºä»€ä¹ˆï¼Œè¯¦æƒ…è§å¦å¤–ä¸€æ–‡ ã€Šgit core.autocrlfé…ç½®è¯´æ˜ã€‹\n","permalink":"https://blog.l50.top/posts/techs/hugo%E5%A4%87%E4%BB%BD%E4%BB%A5%E5%8F%8A%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/","summary":"\u003cp\u003eå½“ä½ åœ¨Windowsä¸‹æ­å»ºhugoæ—¶ä½ å¿…é¡»é¦–å…ˆå°†gité…ç½®ä¸­çš„è‡ªåŠ¨åˆ‡æ¢æ”¹ä¸ºfalseï¼Œå¦‚æœä¸è°ƒæ•´è¯¥é¡¹ï¼Œä½ é€šè¿‡Windowsä¸Šä¼ çš„hugoåˆ°github pageså°†ä¼šæ ·å¼ä¸å¯¹ï¼Œå³ä½¿ä½ åœ¨æœ¬åœ°é¢„è§ˆçš„æ˜¯æ­£ç¡®çš„ä¸»é¢˜ï¼Œä½ åº”å½“åœ¨æ“ä½œä¹‹å‰ä½¿ç”¨ï¼š\u003ccode\u003egit config core.autocrlf false\u003c/code\u003eã€‚\u003c/p\u003e","title":"Hugoå¤‡ä»½ä»¥åŠé‡åˆ°çš„é—®é¢˜"},{"content":"","permalink":"https://blog.l50.top/posts/%E6%9C%AA%E5%91%BD%E5%90%8D/","summary":"","title":""}]